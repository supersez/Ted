                  
   <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Existing meta tags -->
    <meta name="theme-color" content="#ff0000">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>SUPER RED Beat's </title>
  <link rel="icon" href="https://raw.githubusercontent.com/atsuperman/RED/refs/heads/main/Sred.png" type="png/x-icon"> 
    <style>
        body {
    margin: 0;
    font-family: 'Roboto', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    /* Changed from height: 100vh to min-height */
    min-height: 100vh;
    background-color: #f4f4f4;
    /* Changed from overflow: hidden */
    overflow-x: hidden;
    overflow-y: auto; /* Allow vertical scrolling */
    padding: 20px 0; /* Add top/bottom padding */
}

/* Add these at the top of your CSS */
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Poppins:wght@400;600&display=swap');
    
    /* Add a wrapper for main content */
.content-wrapper {
    width: 100%;
    max-width: 800px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1px;
    padding: 20px 0;
}
        .vertical-line {
            position: absolute;
            left: 2%;
            top: 0;
            height: 100%;
            width: 5px;
            background-color: black;
        }

        .current-song {
            font-size: 18px;
            margin-top: 10px;
            color: #333;
            font-weight: bold;
        }

        .a-container, .b-container, .c-container {
    margin-left: 6%;
    padding: 15px;
    border: 2px solid #555;
    border-radius: 10px;
    width: 90%;
    max-width: 500px;
    box-sizing: border-box;
    box-shadow: -5px 5px 15px rgba(0, 0, 0, 0.5),
                5px -5px 15px rgba(50, 255, 50, 0.2);
    margin: 3px 0; /* Add vertical spacing */
}

        .b-container {
            background-color: white;
            color: black;
            font-family: 'Poppins', sans-serif;
            text-shadow: 0 0 5px #f6f5f3, 0 0 10px #f6f5f3, 0 0 20px #f6f5f3;
        }

        .icon-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
        }

        .icon {
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .icon:hover {
            transform: scale(1.2);
        }

        #searchBoxContainer {
            display: none;
            transition: width 0.3s ease;
        }

    

  
  #songQueue h4 {
    font-size: 16px;
    font-weight: bold;
    text-align: center;
    color: #333;
}

#songList::-webkit-scrollbar {
    width: 8px;
}

#songList::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 5px;
}

#songList::-webkit-scrollbar-thumb:hover {
    background: #aaa;
}
    
    /* Song list container */
#songList {
    max-height: 200px;
    overflow-y: auto;
    margin: 10px 0;
    color: #689;
}
    /* Add to your existing CSS */
.song-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 10px;
    width: 100%;
    margin-bottom: 5px;
    white-space: nowrap;
    overflow: hidden;
}

.song-text {
    color: #1d1e22;
    max-width: 70%; 
    overflow: hidden;
    text-overflow: ellipsis;
    display: inline-block;
    vertical-align: middle;
}

.remove-button {
    flex-shrink: 0;
    
}
  
   .remove-button {
    background: #ff4444;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 2px 8px;
    font-size: 12px;
    cursor: pointer;
    transition: background 0.3s ease;
}

.remove-button:hover {
    background: #cc0000;
}

#searchBox {
    /* Existing styles (add these if missing) */
    width: 100%;
    padding: 8px 12px;
    border: 2px solid #666;
    border-radius: 20px;
    font-size: 14px;
    background: #fff;
    transition: all 0.3s ease;
    
    /* Blinking cursor styling */
    caret-color: #j0ff00; /* Neon green cursor color */
    animation: blink 1s step-end infinite;
}

/* Blink animation */
@keyframes blink {
    0%, 100% { border-color: #666; } /* Original border color */
    50% { border-color: #00ff00; } /* Blink to neon green */
}

/* For modern browsers with smooth transition */
#searchBox:focus {
    outline: none;
    border-color: #00ff00;
    box-shadow: 0 0 10px rgba(0, 255, 0, 0.3);
    animation: pulse 1.5s infinite;
}

@keyframes pulse {
    0% { box-shadow: 0 0 0 0 rgba(0, 255, 0, 0.3); }
    70% { box-shadow: 0 0 0 10px rgba(0, 255, 0, 0); }
    100% { box-shadow: 0 0 0 0 rgba(0, 255, 0, 0); }
}
    
/* Each search result fits perfectly inside #c-container */
.search-result-item {
    position: relative;
    width: 100%; /* Ensures full width inside #c-container */
    height: 45px;
    perspective: 1000px;
    cursor: pointer;
    display: flex;
    align-items: left;
    justify-content: flex-start; /* Align text to the left */
    margin-bottom: 4px; /* Space between results */
}

/* Flip container inside each result */
.search-result-item .flip-container {
    position: relative;
    width: 90%;
    height: 100%;
    transition: transform 1.4s ease-in-out;
    transform-style: preserve-3d;
}

/* Front and back sides */
.search-result-item .front,
.search-result-item .back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 8px 12px;
    border-radius: 6px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

/* Front (default view) */
.search-result-item .front {
    background: #d9d9d9;
    color: black;
    overflow: hidden;
}

/* Back (flip effect) */
.search-result-item .back {
    background: #28a745;
    color: white;
    font-weight: bold;
    transform: rotateY(180deg);
    display: flex;
    align-items: center;
}

/* Flip effect when clicked */
.search-result-item.flipped .flip-container {
    transform: rotateY(180deg);
}

/* Song title (single line with ellipsis) */
.song-title {
    font-weight: bold;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-align: left;
}

/* Song details (single line with ellipsis) */
.song-details {
    font-size: 12px;
    color: #555;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-align: left;
}
    
.song-name, .song-details {
    white-space: nowrap;         
    overflow: hidden;            
    text-overflow: ellipsis;     
    width: 100%;                 
    display: block;              
    padding: 2px 0;              
}
    #c-container {
    max-height: 300px;
    margin: 10px 0;
}

/* Container to limit size and allow scrolling if necessary */
#c-container {
    /* Keep existing styles */
    margin-left: 1%;
    padding: 10px;
    border: 2px solid #555;
    border-radius: 10px;
    width: 90%;
    max-width: 500px;
    box-sizing: border-box;
    box-shadow: -5px 5px 15px rgba(0, 0, 0, 0.5),
                5px -5px 15px rgba(50, 255, 50, 0.2);
    
    /* Add these new styles */
    max-height: 300px; /* Fixed height for scroll */
    overflow-y: auto; /* Enable vertical scroll */
    padding-right: 8px; /* Space for scrollbar */
}

    /* Custom scrollbar for c-container */
#c-container::-webkit-scrollbar {
    width: 8px;
}

#c-container::-webkit-scrollbar-track {
    background: rgba(0,0,0,0.1);
    border-radius: 3px;
}

#c-container::-webkit-scrollbar-thumb {
    background: #888;
    border-radius: 3px;
}

#c-container::-webkit-scrollbar-thumb:hover {
    background: #555;
}
    
.duration-display {
  margin-left: auto; /* Push to right side */
  font-size: 11px;
  color: #666;
  font-family: 'Roboto Mono', monospace; /* Monospace for time alignment */
  padding: 1px;
  background: #f0f0f0;
  border-radius: 1px;
}    

/* Add progress bar styles */
.progress-container {
    position: absolute;
    top: -25px;
    left: 0;
    width: 100%;
    height: 20px;
    touch-action: none;
    z-index: 1000;
}

.progress-background {
    position: absolute;
    width: 100%;
    height: 4px;
    background: #666;
    top: 50%;
    transform: translateY(-50%);
}

.progress-line {
    position: absolute;
    height: 4px;
    background: #00ff00;
    width: 0%;
}

.progress-handle {
    position: absolute;
    width: 16px;
    height: 16px;
    background: #00ff00;
    border-radius: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    left: 0;
}

.duration-display {
    position: relative;
    z-index: 1001;
}
    
    .song-item {
    display: flex;
    align-items: center;
    gap: 8px;
}

.small-play-btn {
    cursor: pointer;
    flex-shrink: 0;
    opacity: 0.8;
    transition: all 0.2s ease;
}

.small-play-btn:hover {
    opacity: 1;
    transform: scale(1.1);
}

.small-play-btn.playing svg {
    fill: green;
}

.remove-button {
    margin-left: auto;
}
         /* Song details container */
    #songDetails {
        cursor: pointer;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: inline-block;
        max-width: 85%;
        vertical-align: middle;
        line-height: 1.4;
        transition: all 0.3s ease;
        position: relative;
    }

    /* Expanded state */
    #songDetails.expanded {
        white-space: normal;
        text-overflow: clip;
        overflow: visible;
        display: inline;
        background: rgba(0, 0, 0, 0.1);
        box-shadow: 0 0 8px rgba(0, 255, 0, 0.3);
        padding: 2px 6px;
        border-radius: 3px;
        word-break: break-word;
        max-height: none;
    }

    /* Chevron icon */
    #songDetails::after {
        content: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='%23007BFF'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
        margin-left: 6px;
        display: inline-block;
        vertical-align: middle;
        filter: drop-shadow(0 0 2px #Black);
        transition: all 0.3s ease;
    }

    #songDetails.expanded::after {
        content: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='%2300ff00'%3E%3Cpath d='M7 14l5-5 5 5z'/%3E%3C/svg%3E");
        filter: drop-shadow(0 0 3px #00ff00);
    }

    /* Ensure parent container maintains layout */
    .b-container > #currentSong > div:last-child {
        min-height: 24px;
        display: flex;
        align-items: center;
    }
        .link-container {
            position: relative;
            text-align: center;
            padding: 20px;
        }

        .link {
            font-size: 0.6em; /* Reduced size by 10% (was 2em) */
            font-weight: bold;
            color: Black; /* Black text color */
            text-decoration: none;
            text-shadow: 0 0 3px red; /* Minimal shadow effect */
            animation: glow 4s infinite;
        }

        @keyframes glow {
            0%, 100% {
                text-shadow: 0 0 5px velvet;
            }
            50% {
                text-shadow: 0 0 10px blue;
            }
        }

        .note {
            position: absolute;
            font-size: 1.5em;
            color: black; /* Black musical note color */
            opacity: 0;
            animation: floatUp 10s ease-out forwards;
        }

       @keyframes floatUp {
    0% { transform: translateY(0) scale(1); opacity: 1; }
    100% { transform: translateY(-100vh) scale(0); opacity: 0; }
}


    /* Add these styles to your existing CSS */
#switch {
    position: relative;
    z-index: 2;
    transition: transform 0.3s ease;
}

#switch:active {
    transform: scale(0.9);
}

.links-container {
    position: center;
    top: 1px;
    left: 0%;
    width: 75%;
    max-width: 500px;
    background: rgba(51, 51, 51, 0.9);
    border-radius: 10px;
    padding: 15px;
    display: none;
    flex-direction: column;
    gap: 5px;
    z-index: 1;
    box-shadow: 0 0 20px rgba(0, 0, 0, 1);
    border: 1px solid #ff0000;
}

.link-item {
    color: white;
    cursor: pointer;
    padding: 8px 15px;
    border-radius: 5px;
    background: rgba(25, 11, 00, 6);
    transition: all 0.3s ease;
    text-shadow: 0 0 10px #ffb0r0;
    position: relative;
    overflow: hidden;
}

.link-item:hover {
    background: rgba(255, 0, 0, 0.2);
    transform: translateX(10px);
}

.link-item::before {
    content: '‚ñ∂';
    position: absolute;
    left: -20px;
    transition: left 0.3s ease;
}

.link-item:hover::before {
    left: 5px;
}

.a-container {
    position: relative;
    transition: all 0.3s ease;
}

.a-container.expanded::after {
    content: '';
    position: absolute;
    top: -10px;
    left: -10px;
    right: -10px;
    bottom: -10px;
    background: rgba(255, 0, 0, 0.1);
    border-radius: 15px;
    z-index: -1;
    animation: expand 0.5s ease;
}

@keyframes expand {
    from {
        transform: scale(0.8);
        opacity: 0;
    }
    to {
        transform: scale(1);
        opacity: 1;
    }
}
    
    
    // Add this animation to your CSS
@keyframes linkClick {
    0% {
        transform: scale(1);
        box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
    }
    50% {
        transform: scale(0.95);
        box-shadow: 0 0 20px rgba(255, 0, 0, 0.6);
    }
    100% {
        transform: scale(1);
        box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
    }
}
    
    .logo {
    font-family: 'Arial', sans-serif;
    font-size: clamp(2rem, 8vw, 4rem);
    font-weight: 900;
    text-transform: uppercase;
    background: linear-gradient(45deg, #ff0000, #ff6b6b);
    -webkit-background-clip: text;
    background-clip: text;
    color: #98A945;
    letter-spacing: -2px;
    z-index: 1000; 
    padding: 0;
        position: relative; /* Changed from absolute */
    top: auto;
    left: auto;
    transform: none;
    margin: 60px 0;
    text-align: center;
}

.logo::after {
    content: 'RED Beat`s';
    font-family: 'Arial Unicode MS', 'Nirmala UI', sans-serif;
    font-size: 0.3em;
    background: linear-gradient(45deg, #333, #666);
    -webkit-background-clip: text;
    background-clip: text;
    color: Red;
    position: absolute;
    right: -0.2em;
    bottom: -0.6em;
    text-transform: none;
    letter-spacing: 0;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    
}
    
    
   /* Add to existing CSS */
.song-item {
    transition: all 0.5s ease;
    transform-origin: center;
    overflow: hidden; /* Prevent content bleed during animation */
}

/* Removal animation */
.song-item.removing {
    animation: removeItem 0.8s ease forwards;
}

@keyframes removeItem {
    0% {
        transform: scale(1);
        opacity: 1;
        max-height: 100px;
    }
    30% {
        transform: scale(0.95);
        background-color: #ff444433;
    }
    100% {
        transform: scale(0.5) translateX(100%);
        opacity: 0;
        max-height: 0;
        margin-bottom: 0;
        padding: 0;
    }
}

/* Text fade effect */
.song-item.removing .song-text {
    animation: textFade 0.5s ease forwards;
}

@keyframes textFade {
    0% { opacity: 1; }
    100% { 
        opacity: 0;
        transform: translateX(-20px);
    }
}

/* Button shrink effect */
.song-item.removing .remove-button {
    animation: buttonShrink 0.4s ease forwards;
}

@keyframes buttonShrink {
    0% { transform: scale(1); }
    100% { transform: scale(0); }
} 
    
    
/* Revised moving to top animation */
.song-item.moving-up {
    animation: cyberMove 0.8s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards;
    filter: hue-rotate(0deg);
    z-index: 100;
}

@keyframes cyberMove {
    0% {
        transform: translateY(0) scale(1);
        opacity: 1;
        box-shadow: 0 0 10px rgba(0, 255, 0, 0.3);
    }
    30% {
        transform: translateY(-20px) scale(1.1) rotateZ(-2deg);
        filter: hue-rotate(90deg);
        box-shadow: 0 0 20px rgba(0, 255, 0, 0.6);
        opacity: 0.9;
    }
    60% {
        transform: translateY(-80px) scale(0.8) rotateZ(3deg);
        filter: hue-rotate(180deg);
        opacity: 0.7;
        box-shadow: 0 0 30px rgba(0, 255, 0, 0.8);
    }
    80% {
        transform: translateY(-120px) scale(0.9) rotateZ(-1deg);
        filter: hue-rotate(270deg);
        opacity: 0.4;
    }
    100% {
        transform: translateY(-150%) scale(1.2) rotateZ(0);
        opacity: 0;
        filter: hue-rotate(360deg);
        box-shadow: 0 0 40px rgba(0, 255, 0, 1);
    }
}

/* Glitch effect during movement */
@keyframes glitch {
    0% { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); }
    20% { clip-path: polygon(0 8%, 100% 22%, 100% 78%, 0 92%); }
    40% { clip-path: polygon(0 42%, 100% 28%, 100% 68%, 0 58%); }
    60% { clip-path: polygon(0 82%, 100% 68%, 100% 98%, 0 88%); }
    80% { clip-path: polygon(0 32%, 100% 18%, 100% 58%, 0 48%); }
    100% { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); }
}

.song-item.moving-up::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, 
        transparent 45%,
        rgba(0, 255, 0, 0.2) 50%,
        transparent 55%
    );
    animation: glitch 0.8s steps(4) infinite;
    mix-blend-mode: overlay;
}

/* Neon trail effect */
.song-item.moving-up::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 150%;
    height: 150%;
    background: radial-gradient(circle, 
        rgba(0, 255, 0, 0.4) 0%,
        rgba(0, 255, 0, 0.3) 30%,
        rgba(0, 255, 0, 0.1) 60%,
        transparent 100%
    );
    transform: translate(-50%, -50%);
    animation: trail 0.8s ease-out forwards;
}

@keyframes trail {
    0% { opacity: 1; transform: translate(-50%, -50%) scale(0); }
    100% { opacity: 0; transform: translate(-50%, -50%) scale(3); }
}

.delete-icon {
    position: fixed;
    bottom: 20px;
    right: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    z-index: 1000;
}

.delete-icon:hover {
    transform: scale(1.1) rotate(15deg);
}

.delete-icon.active {
    animation: shake 0.5s ease;
}

@keyframes shake {
    0% { transform: translateX(0); }
    25% { transform: translateX(5px); }
    50% { transform: translateX(-5px); }
    75% { transform: translateX(5px); }
    100% { transform: translateX(0); }
}

.delete-icon path {
    transition: all 0.3s ease;
}

.delete-icon.active .lid {
    transform: rotate(-30deg);
    transform-origin: 52px 24px;
}
    
/* Flash message styles */
.flash-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: radial-gradient(circle at 50% 50%, 
        transparent 0px, 
        rgba(255, 255, 255, 0.85) 4px);
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(-1px);
    cursor: pointer;
}

.flash-message {
    background: rgba(255, 240, 240, 0.95);
    padding: 20px;
    border-radius: 15px;
    max-width: 300px;
    text-align: center;
    border: 2px solid rgba(255, 0, 0, 0.3);
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
    font-size: 14px;
    line-height: 1.4;
    pointer-events: none;
}

/* Play button cutout area */
#play-pause {
    position: relative;
    z-index: 10000;
}
    
.logo-container {
    position: relative;
    display: inline-block;
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
}

.logo, .delete-icon {
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.delete-icon {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%) scale(0);
    opacity: 0;
    pointer-events: none;
    z-index: 1001;
}

.logo-container.active .logo {
    opacity: 0;
    transform: scale(0.8);
}

.logo-container.active .delete-icon {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
    pointer-events: all;
}

.delete-icon svg {
    transition: transform 0.3s ease;
}

.delete-icon:hover svg {
    transform: rotate(15deg) scale(1.1);
}
    
  .safe-rotating-text {
    position: relative;
    display: block;
    margin: 12px 6% 0 auto;
    width: 88%;
    max-width: 500px;
    text-align: right;
    height: 24px;
    overflow: hidden;
    perspective: 1000px;
}

.safe-text {
    position: absolute;
    width: auto;
    right: 0;
    font: 600 10px 'Poppins', sans-serif;
    color: #ff00ff;
    text-shadow: 
        0 0 10px rgba(255,0,255,0.3),
        0 0 20px rgba(0,255,255,0.3);
    transition: all 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    background: linear-gradient(45deg, #ff00ff, #00ffff);
    -webkit-background-clip: text;
    background-clip: text;
    padding-right: 10px;
    transform-origin: right center;
}

/* New Transformation Effects */
.safe-visible {
    opacity: 1;
    transform: translateX(0) rotate(0deg) scale(1);
    filter: blur(0);
}

.safe-hidden {
    opacity: 0;
    transform: translateX(20px) rotate(-5deg) scale(1.2);
    filter: blur(2px);
}

/* Hover Effects */
.safe-rotating-text:hover .safe-text {
    transform: translateX(-5px) rotate(1deg);
    text-shadow: 
        0 0 15px rgba(255,0,255,0.6),
        0 0 30px rgba(0,255,255,0.6);
}

/* Active/Click Effect */
.safe-rotating-text:active .safe-text {
    transform: translateX(2px) scale(0.98);
    transition: all 0.2s ease;
}
      
    
    
        @media screen and (max-width: 768px) {
          #songList::-webkit-scrollbar-thumb {
        background: #888 !important;
    }
}
            
body {
        padding: 5px 0;
    }
    
    .content-wrapper {
        gap: 5px;
        padding: 10px 0;
    }
    
    .a-container, .b-container, .c-container {
        margin: 1px 0;
        padding: 10px;
    }
    
    .logo {
        margin: 45px 0;
        font-size: 1.8rem;
    }
        
    .links-container {
        
        position: relative;
    margin: 10px 0;
    top: auto;
    left: auto;
    transform: none;
        
        width: 75%;
        max-width: none;
        padding: 10px;
        gap: 8px;
        background: rgba(51, 51, 51, 0.9);
    }

    .link-item {
        font-size: 14px;
        padding: 10px 12px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .link-item:hover {
        transform: none;
    }

    .link-item::before {
        content: '';
        display: none;
    }

    .link-item:hover::before {
        left: -20px;
    }
   .vertical-line {
        left: 5px; /* Adjust for small screens */
    }
    
  

    /* Better touch targets */
    .link-item {
        min-height: 44px;
        display: flex;
        align-items: center;
    }

    /* Mobile tap feedback */
    .link-item:active {
        background: rgba(255, 0, 0, 0.3);
        transform: scale(0.98);
    }


            .icon-row .icon {
                font-size: 1.2rem;
            }

            .b-container {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="content-wrapper">
  <div class="logo-container" id="logoContainer">
    <h1 class="logo">SUPER</h1>
    <div class="delete-icon" id="deleteIcon">
        <svg width="60" height="60" viewBox="0 0 60 60">
            <path class="lid" d="M20 15h20l-2-4H22z" fill="orange"/>
            <path d="M25 20v25h2V20zm8 0v25h2V20zm8 0v25h2V20zm5 30H14V20h32v30z" fill="silver"/>
        </svg>
    </div>
</div>
<div class="links-container" id="linksContainer">
    <div class="link-item" data-url="https://atsuperman.github.io/isai/">‡Æá‡Æö‡Øà</div>

</div>
  <div class="c-container" id="c-container" style="display: none;">
  <h4>search Results..</h4>
  <ul id="search-results">
    <!-- Search results will be dynamically inserted here -->
  </ul>
</div>
    <div class="vertical-line"></div>
    <!-- A-container for Play/Pause toggle -->

   <div class="a-container">
       <div class="icon-row">
    <span class="icon" id="play-pause" aria-label="Play/Pause">
        <svg width="24" height="24" viewBox="0 0 24 24">
            <path id="play-path" d="M8 5v14l11-7z" />
            <path id="pause-path" d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" style="display: none;" />
        </svg>
    </span>
  <span class="icon" id="next" aria-label="Next Track">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="#000000">
        <path d="M4 4v16l12-8-12-8zm14 0h2v16h-2z"></path>
    </svg>
</span>
          
<span class="icon" id="search">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="#000000">
        <path d="M21.71 20.29l-5.37-5.37A7.92 7.92 0 0 0 18 10a8 8 0 1 0-8 8 7.92 7.92 0 0 0 4.92-1.66l5.37 5.37a1 1 0 0 0 1.42-1.42ZM10 16a6 6 0 1 1 6-6 6 6 0 0 1-6 6Z"></path>
    </svg>
</span>
           <span class="icon" id="list">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="#000000">
        <path d="M4 6h16v2H4V6zm0 5h16v2H4v-2zm0 5h16v2H4v-2z"></path>
    </svg>
</span>
       <span class="icon" id="switch">
    <svg width="50" height="24" viewBox="0 0 50 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect width="50" height="24" rx="12" fill="#E0E0E0"/>
        <circle id="toggle" cx="6" cy="12" r="6" fill="#000000"/>
    </svg>
</span>
         <div id="searchBoxContainer">
    <!-- Removed the previous searchResults container -->
    <input type="text" id="searchBox" placeholder="Search.. Movie / song / artist" />
</div>
            <!-- Remove this block -->
<div id="durationDisplay" class="duration-display">
  0:00 / 0:00
</div>
       </div>
       <!-- Add progress bar HTML inside a-container -->
<div class="progress-container" id="progressContainer" style="display: none;">
    <div class="progress-background"></div>
    <div class="progress-line" id="progressLine"></div>
    <div class="progress-handle" id="progressHandle"></div>
</div>
       
   </div>
    
    
    <!-- B-container left empty -->
<div class="b-container">
    <div id="currentSong">
        <div style="display: block; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"> 
            <svg width="16" height="16" viewBox="0 0 24 24" fill="#007BFF" style="margin-right: 5px;">
                <path d="M12 3v18l9-9-9-9zm-9 9h7v-2H3v2zm0 4h7v-2H3v2zm0-8h7V7H3v2z"></path>
            </svg>
            <span id="currentSongName" style="font-weight: bold; color: #000000;"></span> 
        </div>
        <div style="display: block;">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="#555" style="margin-right: 5px;">
                <path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2Zm1 15h-2v-2h2Zm0-4h-2V7h2Z"></path>
            </svg>
            <span id="songDetails" style="font-size: 14px; color: #000000;"></span>
        </div>
    </div>

  <div id="songQueue" style="display: none; margin-top: 20px;">
    <h4 style="margin-bottom: 10px; color: blue; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
    Next Up ‚Ü¥ 
    <button id="reloadBtn" style="margin-left: 10px; padding: 2px 8px; font-size: 12px; cursor: pointer; background: #4CAF50; color: white; border: none; border-radius: 4px;">Reload</button>
</h4>
    <div id="songList" style="max-height: 200px; overflow-y: auto; border: 1px solid blue; border-radius: 5px; padding: 10px; background: #c89666;">
        </div>
      <div class="link-container">
       <a href="https://fb.com/atSUPERMAN" 
   target="_blank" 
   rel="noopener noreferrer" 
   class="link">‚ìï atSUPERMAN</a>
    </div>

</div>
</div>

<div class="safe-rotating-text">
    <a href="catalog.html" target="_blank" rel="noopener noreferrer" class="safe-link">
        <span class="safe-text safe-visible">VERSION 4.1</span>
        <span class="safe-text safe-hidden">How to Use?</span>
    </a>
</div>

<div id="flashOverlay" class="flash-overlay">
    <div class="flash-message">
        ‚ö†Ô∏è Before you start listening, use headphones for the best experience. 
        Some songs may be suitable only for adults / matured agers <br><br>
        üîû Songs may contain inappropriate words and should not be played loudly in public places
    </div>
</div>

      <audio id="audioPlayer">
        Your browser does not support the audio element.
    </audio>

 <script type="module">
    import { allSongs } from './redfiles.js';
let isListVisible = false;
let isSearchVisible = false;
let currentIndex = -1;
let playlist = [];
let originalSongs = [...allSongs];
let wakeLock = null;
let isTabVisible = true;
// Add these variables at the top of your script
let isProgressDragging = false;
let progressContainer = document.getElementById('progressContainer');
let progressLine = document.getElementById('progressLine');
let progressHandle = document.getElementById('progressHandle');

// Add touch handler for duration display
document.getElementById('durationDisplay').addEventListener('click', function(e) {
    progressContainer.style.display = progressContainer.style.display === 'none' ? 'block' : 'none';
});

// Progress bar touch handlers
progressContainer.addEventListener('touchstart', handleProgressStart);
document.addEventListener('touchmove', handleProgressMove);
document.addEventListener('touchend', handleProgressEnd);

function handleProgressStart(e) {
    e.preventDefault();
    isProgressDragging = true;
    updateProgress(e.touches[0].clientX);
}

function handleProgressMove(e) {
    if (!isProgressDragging) return;
    updateProgress(e.touches[0].clientX);
}

function handleProgressEnd() {
    isProgressDragging = false;
}

function updateProgress(clientX) {
    const rect = progressContainer.getBoundingClientRect();
    const percentage = Math.max(0, Math.min(1, (clientX - rect.left) / rect.width));
    const audioPlayer = document.getElementById('audioPlayer');
    
    if (audioPlayer.duration) {
        audioPlayer.currentTime = percentage * audioPlayer.duration;
        updateProgressDisplay(percentage);
    }
}

function updateProgressDisplay(percentage) {
    progressLine.style.width = `${percentage * 100}%`;
    progressHandle.style.left = `${percentage * 100}%`;
}

// Update progress bar during playback
audioPlayer.addEventListener('timeupdate', () => {
    if (!isProgressDragging && audioPlayer.duration) {
        const percentage = audioPlayer.currentTime / audioPlayer.duration;
        updateProgressDisplay(percentage);
    }
});

    // Initialize wake lock
    async function requestWakeLock() {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (err) {
            console.log('Wake Lock error:', err);
        }
    }

    // Tab visibility handler
    document.addEventListener('visibilitychange', () => {
        const audioPlayer = document.getElementById('audioPlayer');
        isTabVisible = document.visibilityState === 'visible';
        
        if (isTabVisible) {
            requestWakeLock();
            if (audioPlayer.paused && playlist.length > 0) {
                audioPlayer.play().catch(console.error);
            }
        } else {
            if (wakeLock) wakeLock.release();
        }
    });

// Function to shuffle array
function shuffleArray(array) {
       for (let i = array.length - 1; i > 0; i--) {
         const j = Math.floor(Math.random() * (i + 1));
         [array[i], array[j]] = [array[j], array[i]];
       }
       return array;
     }

// Function to update playlist UI live
// Function to update playlist display with max 7 songs and scrolling
let currentSmallPlayer = null;

function updatePlaylist() {
    let songListContainer = document.getElementById('songList');
    songListContainer.innerHTML = "";

    playlist.forEach((song, index) => {
        let songItem = document.createElement('div');
        songItem.classList.add('song-item');

        let songText = document.createElement('span');
    songText.classList.add('song-text');
    
    // Clean filename: remove extension and underscores
    const cleanName = song.file
   
        .replace(/\.[^.]+$/, '') // Remove any file extension
        .replace(/_/g, ' ')      // Replace underscores with spaces
        .replace(/-/g, ' ');     // Optional: Replace hyphens with spaces
    
    songText.textContent = cleanName;


        // Create play/pause button
        let playBtn = document.createElement('div');
        playBtn.classList.add('small-play-btn');
        playBtn.innerHTML = `
            <svg width="20" height="20" viewBox="0 0 24 24">
                <path class="small-play" d="M8 5v14l11-7z" />
                <path class="small-pause" d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" style="display: none;" />
            </svg>
        `;

        // Play/pause handler
        // Modified playBtn click handler
playBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    const audioPlayer = document.getElementById('audioPlayer');
    
    // Stop main player and all other small players
    stopMainPlayer();
    stopAllSmallPlayers(playBtn);

    // Handle current small player state
    if (playBtn.audio) {
        if (playBtn.audio.paused) {
            // Resume playback from current position
            const remaining = playBtn.previewEndTime - playBtn.audio.currentTime;
            playBtn.audio.play();
            playBtn.timeoutId = setTimeout(() => {
                playBtn.audio.pause();
                updateSmallIcons(playBtn, false);
            }, remaining * 1000);
            playBtn.classList.add('playing');
            currentSmallPlayer = playBtn;
            updateSmallIcons(playBtn, true);
        } else {
            // Pause playback
            clearTimeout(playBtn.timeoutId);
            playBtn.audio.pause();
            playBtn.classList.remove('playing');
            updateSmallIcons(playBtn, false);
        }
    } else {
        // Start new preview playback
        playBtn.audio = new Audio(song.path);
        
        // When metadata is loaded, set up preview
        playBtn.audio.addEventListener('loadedmetadata', () => {
            // Calculate middle 30 seconds
            const duration = playBtn.audio.duration;
            const startTime = Math.max((duration/2) - 15, 0); // Start 15s before middle
            const endTime = Math.min(startTime + 30, duration);
            
            playBtn.audio.currentTime = startTime;
            playBtn.previewEndTime = endTime;
            
            // Play the preview
            playBtn.audio.play();
            currentSmallPlayer = playBtn;
            updateSmallIcons(playBtn, true);
            
            // Set timeout to stop at 30 seconds
            playBtn.timeoutId = setTimeout(() => {
                playBtn.audio.pause();
                updateSmallIcons(playBtn, false);
                playBtn.audio = null;
            }, (endTime - startTime) * 1000);
            
            // Handle manual stop
            playBtn.audio.addEventListener('ended', () => {
                clearTimeout(playBtn.timeoutId);
                playBtn.classList.remove('playing');
                updateSmallIcons(playBtn, false);
                playBtn.audio = null;
            });
        });
    }
});

// Inside the playlist.forEach((song, index) => { ... }) loop in updatePlaylist()
songItem.dataset.songPath = song.path; // Add data attribute
songItem.addEventListener('click', function(e) {
    e.stopPropagation();
    
    // Add moving-up class for animation
    this.classList.add('moving-up');
    
    setTimeout(() => {
        // Rest of your existing code
        stopMainPlayer();
        stopAllSmallPlayers();
        
        const songPath = this.dataset.songPath;
        const songIndex = playlist.findIndex(s => s.path === songPath);
        
        if (songIndex === -1) return;
        
        const [selectedSong] = playlist.splice(songIndex, 1);
        playlist.unshift(selectedSong);
        
        updatePlaylist();
        playSong(0);
        
        // Remove class after animation
        this.classList.remove('moving-up');
    }, 400);
});
        
    // Enhanced Media Session
    // ====================
    if ('mediaSession' in navigator) {
        navigator.mediaSession.setActionHandler('play', () => {
            audioPlayer.play();
            updatePlayPauseIcon();
        });
        
        navigator.mediaSession.setActionHandler('pause', () => {
            audioPlayer.pause();
            updatePlayPauseIcon();
        });
        
        navigator.mediaSession.setActionHandler('nexttrack', () => {
            document.getElementById('next').click();
        });
    }


// Add these helper functions
function stopMainPlayer() {
    const audioPlayer = document.getElementById('audioPlayer');
    if (!audioPlayer.paused) {
        audioPlayer.pause();
        updatePlayPauseIcon();
    }
}

function stopAllSmallPlayers(exceptThis = null) {
    document.querySelectorAll('.small-play-btn').forEach(btn => {
        if (btn !== exceptThis && btn.audio) {
            clearTimeout(btn.timeoutId);
            btn.audio.pause();
            btn.audio.currentTime = 0;
            btn.classList.remove('playing');
            updateSmallIcons(btn, false);
            btn.audio = null;
        }
    });
}
function updateSmallIcons(button, isPlaying) {
    button.querySelector('.small-play').style.display = isPlaying ? 'none' : 'block';
    button.querySelector('.small-pause').style.display = isPlaying ? 'block' : 'none';
}

        // Remove button
        let removeBtn = document.createElement('button');
        removeBtn.classList.add('remove-button');
        removeBtn.textContent = "X";
        removeBtn.onclick = (e) => {
    e.stopPropagation();
    songItem.classList.add('removing');
    setTimeout(() => {
        playlist.splice(index, 1);
        updatePlaylist();
    }, 700); // Match animation duration
};

        // Add elements to DOM
        songItem.appendChild(playBtn);
        songItem.appendChild(songText);
        songItem.appendChild(removeBtn);
        songListContainer.appendChild(songItem);
    });

    songListContainer.style.maxHeight = "200px";
    songListContainer.style.overflowY = "auto";
}

// Function to play a song
function playSong(index) {
    let audioPlayer = document.getElementById('audioPlayer');
    let playPath = document.getElementById('play-path');
    let pausePath = document.getElementById('pause-path');

    // Force background audio capabilities
        audioPlayer.mozPreservesPitch = false;
        audioPlayer.webkitPreservesPitch = false;
        
    if (index >= playlist.length) {
        playlist = shuffleArray([...originalSongs]); // Reshuffle when all are played
        updatePlaylist();
        index = 0;
    }

        currentIndex = index;
        const song = playlist[currentIndex];
        audioPlayer.src = song.path;
    // Clean up song name display (remove .mp3 extension)
    const cleanSongName = song.file.replace(/\.(mp3|m4a)$/i, '').replace(/_/g, ' ');
    document.getElementById('currentSongName').textContent = cleanSongName;
    
    // Format details with fallback
    const details = song.details || "Unknown Artist - Unknown Album";
    document.getElementById('songDetails').textContent = details;
        // Update media session metadata
        if ('mediaSession' in navigator) {
            navigator.mediaSession.metadata = new MediaMetadata({
                title: song.file.replace(/\.(mp3|m4a)$/i, ''),
                artist: song.details || 'Unknown Artist',
                artwork: [{
                    src: 'https://raw.githubusercontent.com/atsuperman/RED/refs/heads/main/Sred.png',
                    sizes: '192x192',
                    type: 'image/png'
                }]
            });
        }

    audioPlayer.play().then(() => {
            // Background playback optimization
            if (!isTabVisible) {
                audioPlayer.mozPreservesPitch = false;
                audioPlayer.webkitPreservesPitch = false;
            }
        }).catch(error => {
            console.log('Playback error:', error);
        });

    // Remove the song immediately after playing
    playlist.splice(currentIndex, 1);
    updatePlaylist();

    
        // Update media session metadata
    if ('mediaSession' in navigator) {
        navigator.mediaSession.metadata = new MediaMetadata({
            title: song.file.replace(/\.(mp3|m4a)$/i, ''),
            artist: song.details || 'Unknown Artist',
            // artwork: [{ src: 'album-art.jpg', sizes: '96x96', type: 'image/jpeg' }]
        });

        // Set media session actions
        navigator.mediaSession.setActionHandler('play', () => {
            audioPlayer.play();
            updatePlayPauseIcon();
        });

        navigator.mediaSession.setActionHandler('pause', () => {
            audioPlayer.pause();
            updatePlayPauseIcon();
        });

        navigator.mediaSession.setActionHandler('nexttrack', () => {
            document.getElementById('next').click();
        });

        // Limit shown controls
        navigator.mediaSession.setPositionState(null); // Remove progress bar
        navigator.mediaSession.playbackState = 'playing';
    }


}

// Auto-play next song when current ends
document.getElementById('audioPlayer').addEventListener('ended', () => {
    if (playlist.length > 0) {
        playSong(0);
    } else {
        playlist = shuffleArray([...originalSongs]); // Reshuffle for a new order
        updatePlaylist();
        playSong(0);
    }
});
  // Persistent Queue
    // ====================
    function saveQueue() {
        localStorage.setItem('musicQueue', JSON.stringify({
            playlist,
            currentIndex,
            currentTime: audioPlayer.currentTime
        }));
    }

    function loadQueue() {
        const saved = localStorage.getItem('musicQueue');
        if (saved) {
            const data = JSON.parse(saved);
            playlist = data.playlist;
            currentIndex = data.currentIndex;
            if (currentIndex >= 0) {
                audioPlayer.currentTime = data.currentTime;
                playSong(currentIndex);
            }
        }
    }

    // Initialize queue
    window.addEventListener('load', () => {
        loadQueue();
        requestWakeLock();
    });

    // Save queue on changes
    audioPlayer.addEventListener('timeupdate', saveQueue);
    window.addEventListener('beforeunload', saveQueue);



/// Modified play/pause handler with small player coordination
document.getElementById('play-pause').addEventListener('click', () => {
    const audioPlayer = document.getElementById('audioPlayer');
    const playPath = document.getElementById('play-path');
    const pausePath = document.getElementById('pause-path');

    // New: Pause all small players while keeping original logic
    document.querySelectorAll('.small-play-btn').forEach(btn => {
        if (btn.audio && !btn.audio.paused) {
            btn.audio.pause();
            btn.classList.remove('playing');
            btn.querySelector('.small-play').style.display = 'block';
            btn.querySelector('.small-pause').style.display = 'none';
        }
    });

    // Original logic preserved
    if (audioPlayer.paused && currentIndex !== -1) {
        audioPlayer.play();
    } else if (!audioPlayer.paused) {
        audioPlayer.pause();
    } else {
        playSong(0);
    }

    updatePlayPauseIcon();
});
// Ensure the play/pause icon updates when audio plays or pauses
audioPlayer.addEventListener('play', updatePlayPauseIcon);
audioPlayer.addEventListener('pause', updatePlayPauseIcon);
audioPlayer.addEventListener('ended', updatePlayPauseIcon);
    
    // Add these audio event listeners
audioPlayer.addEventListener('play', () => {
    if ('mediaSession' in navigator) {
        navigator.mediaSession.playbackState = 'playing';
    }
});

audioPlayer.addEventListener('pause', () => {
    if ('mediaSession' in navigator) {
        navigator.mediaSession.playbackState = 'paused';
    }
});
    
   // Add at the end of your window load event listener
window.addEventListener('load', () => {
    loadQueue();
    requestWakeLock();
    
    // Auto-reload once after 5 seconds
    setTimeout(() => {
        playlist = shuffleArray([...originalSongs]);
        updatePlaylist();
    }, 5000);
});

// Keep existing reload button handler
document.getElementById('reloadBtn').addEventListener('click', () => {
    playlist = shuffleArray([...originalSongs]);
    updatePlaylist();
});

    // Inside playSong() function - Add this after audioPlayer.src = song.path:
audioPlayer.addEventListener('loadedmetadata', () => {
  const duration = audioPlayer.duration;
  document.getElementById('durationDisplay').textContent = 
    `0:00 / ${formatTime(duration)}`;
});

// Add this new function to format time (MM:SS)
function formatTime(seconds) {
  const mins = Math.floor(seconds / 60);
  const secs = Math.floor(seconds % 60);
  return `${mins}:${secs.toString().padStart(2, '0')}`;
}

function calculatePreviewTime(duration) {
    const start = Math.max((duration / 2) - 15, 0);
    const end = Math.min(start + 30, duration);
    return { start, end };
}
// Add timeupdate listener (outside playSong):
audioPlayer.addEventListener('timeupdate', () => {
  const current = audioPlayer.currentTime;
  const duration = audioPlayer.duration;
  document.getElementById('durationDisplay').textContent = 
    `${formatTime(current)} / ${formatTime(duration)}`;
});

// Function to update play/pause icon
function updatePlayPauseIcon() {
    let audioPlayer = document.getElementById('audioPlayer');
    let playPath = document.getElementById('play-path');
    let pausePath = document.getElementById('pause-path');

    if (audioPlayer.paused) {
        playPath.style.display = "block";
        pausePath.style.display = "none";
    } else {
        playPath.style.display = "none";
        pausePath.style.display = "block";
    }
}
// Function to play the next song (removes current and updates instantly)
document.getElementById('next').addEventListener('click', () => {
    if (playlist.length > 0) {
        playSong(0);
    } else {
        playlist = shuffleArray([...originalSongs]); // Reshuffle if finished
        updatePlaylist();
        playSong(0);
    }
});

// Toggle song list - Do not refresh playlist
document.getElementById('list').addEventListener('click', () => {
    isListVisible = !isListVisible;
    document.getElementById('songQueue').style.display = isListVisible ? 'block' : 'none';

    // Do not refresh or shuffle the playlist on toggle
});
    
// Toggle search box and retain selected songs
let autoHideTimer; // Variable to store the timeout

document.getElementById('search').addEventListener('click', () => {
    isSearchVisible = !isSearchVisible;

    let searchBox = document.getElementById('searchBoxContainer');
    let icons = document.querySelectorAll('.icon:not(#search), #durationDisplay'); // Added duration display

    if (isSearchVisible) {
        searchBox.style.display = 'block';
        document.getElementById('c-container').style.display = 'block';
        // Hide ALL icons AND duration display
        icons.forEach(element => element.style.display = 'none');
        resetAutoHideTimer();
    } else {
        hideSearchBox();
    }
});

// Function to hide the search box and show icons
function hideSearchBox() {
    let searchBox = document.getElementById('searchBoxContainer');
    let icons = document.querySelectorAll('.icon:not(#search), #durationDisplay'); // Added duration display

    searchBox.style.display = 'none';
    document.getElementById('c-container').style.display = 'none';
    // Show all icons AND duration display
    icons.forEach(element => element.style.display = 'inline-block');
    document.getElementById('search-results').innerHTML = "";
}

// Rest of the code remains unchanged...
// Function to reset and start the auto-hide timer
function resetAutoHideTimer() {
    clearTimeout(autoHideTimer); // Clear any existing timer
    autoHideTimer = setTimeout(() => {
        if (isSearchVisible) hideSearchBox(); // Auto-hide if search box is open
    }, 30000); // 30 seconds delay
}

// Detect user input or interaction to reset the timer
document.addEventListener('keydown', resetAutoHideTimer);
document.addEventListener('mousemove', resetAutoHideTimer);
document.addEventListener('click', resetAutoHideTimer);
    
    
// Search functionality - Ensure chosen song is added at the top of the playlist
document.getElementById('searchBox').addEventListener('input', (e) => {
    let query = e.target.value.toLowerCase();
    let resultsContainer = document.getElementById('search-results');

    if (query.length === 0) {
        resultsContainer.innerHTML = "";
        return;
    }

    resultsContainer.innerHTML = "";

    if (query.length > 0) {
        let filteredSongs = allSongs.filter(song => {
            let songNameWithoutExt = song.file.replace(/(\.[\w\d]+)$/i, "").toLowerCase();
            let songDetailsLower = (song.details || "").toLowerCase(); // Handle missing details
            return songNameWithoutExt.includes(query) || songDetailsLower.includes(query); // Search in name OR details
        });

        let maxResults = 20;
        let resultsToShow = filteredSongs.slice(0, maxResults);

        resultsToShow.forEach(song => {
            let songNameWithoutExt = song.file.replace(/(\.[\w\d]+)$/i, "").replace(/_/g, " ");

            let listItem = document.createElement('div');
            listItem.classList.add('search-result-item');

            let flipContainer = document.createElement('div');
            flipContainer.classList.add('flip-container');

            let front = document.createElement('div');
            front.classList.add('front');

            let songName = document.createElement('div');
            songName.classList.add('song-name');
            songName.textContent = songNameWithoutExt;

            let songDetails = document.createElement('div');
            songDetails.classList.add('song-details');
            songDetails.textContent = song.details || "No details available";

            front.appendChild(songName);
            front.appendChild(songDetails);

            let back = document.createElement('div');
            back.classList.add('back');
            back.textContent = "ADDED to NEXT UP ‚úî";

            flipContainer.appendChild(front);
            flipContainer.appendChild(back);
            listItem.appendChild(flipContainer);

            listItem.onclick = () => {
                let selectedSong = { ...song };

                playlist.unshift(selectedSong);
                updatePlaylist();

                listItem.classList.add('flipped');

                setTimeout(() => {
                    listItem.remove();
                }, 4000);
            };

            resultsContainer.appendChild(listItem);
        });
    }
});

    
    audioPlayer.addEventListener('error', (e) => {
       console.error('Audio error:', audioPlayer.error);
       playNextSong(); // Auto-skip to next song
     });
    
    
    
        document.getElementById('songDetails').addEventListener('click', function(e) {
        e.stopPropagation();
        const wasExpanded = this.classList.contains('expanded');
        
        // Collapse all first
        this.classList.remove('expanded');
        
        // Toggle state after layout update
        requestAnimationFrame(() => {
            if (!wasExpanded) {
                this.classList.add('expanded');
                // Auto-collapse after 15 seconds
                setTimeout(() => {
                    this.classList.remove('expanded');
                }, 15000);
            }
        });
    });

    // Collapse when clicking elsewhere
    document.addEventListener('click', function(e) {
        const details = document.getElementById('songDetails');
        if (!details.contains(e.target)) {
            details.classList.remove('expanded');
        }
    });

    const container = document.querySelector('.link-container');

        // Generate musical notes dynamically
        function createNote() {
            const note = document.createElement('div');
            note.classList.add('note');
            note.textContent = randomNote();
            
            // Random position around the link
            const randomX = Math.random() * container.offsetWidth - 10;
            const randomY = Math.random() * 20 - 10; // Around the link height

            note.style.left = `${randomX}px`;
            note.style.bottom = `10px`; // Fixed near link

            container.appendChild(note);

            // Remove the note after animation ends
            setTimeout(() => {
                note.remove();
            }, 10000);
        }

        // Return a random musical symbol
        function randomNote() {
            const notes = ['‚ô™', '‚ô´','üé∏','üé∑','üíø','üéß','üé∂','üï∫üèº','üíÉüèº','üí´','‚ú®', '‚ô¨','üé∫', '‚ô©'];
            return notes[Math.floor(Math.random() * notes.length)];
        }

        // Continuously generate notes
        setInterval(createNote, 15550);

    
// Add this to your existing JavaScript
document.getElementById('switch').addEventListener('click', function() {
    const linksContainer = document.getElementById('linksContainer');
    const aContainer = document.querySelector('.a-container');
    const toggle = document.getElementById('toggle');
    
    // Toggle links visibility
    linksContainer.style.display = linksContainer.style.display === 'flex' ? 'none' : 'flex';
    
    // Toggle switch position and color
    const isLeft = toggle.getAttribute('cx') === '6';
    toggle.setAttribute('cx', isLeft ? '44' : '6');
    toggle.setAttribute('fill', isLeft ? '#ff0000' : '#000000');
    
    // Add/remove expanded effect
    aContainer.classList.toggle('expanded');
});

// Modify the existing link handler code
document.querySelectorAll('.link-item').forEach(link => {
    link.addEventListener('click', function(e) {
        e.preventDefault(); // Add this line
        const url = this.dataset.url;
        window.open(url, '_blank', 'noopener,noreferrer');
        this.style.animation = 'linkClick 0.5s';
        setTimeout(() => {
            this.style.animation = '';
        }, 500);
    });
});
   
   document.getElementById('deleteIcon').addEventListener('click', async function() {
    // Add animation
    this.classList.add('active');
    
    // Clear caches
    try {
        // Clear localStorage
        localStorage.clear();
        
        // Clear service workers
        const registrations = await navigator.serviceWorker.getRegistrations();
        for(let registration of registrations) {
            await registration.unregister();
        }
        
        // Clear cache API
        if('caches' in window) {
            await caches.keys().then(cacheNames => {
                return Promise.all(cacheNames.map(cacheName => {
                    return caches.delete(cacheName);
                }));
            });
        }
        
        // Force reload
        setTimeout(() => {
            window.location.reload(true);
        }, 1000);
        
    } catch(error) {
        console.error('Cache clearing failed:', error);
    }
    
    // Remove animation after 1s
    setTimeout(() => {
        this.classList.remove('active');
    }, 1000);
});
    
    // Flash message handling
const flashOverlay = document.getElementById('flashOverlay');
const playPauseBtn = document.getElementById('play-pause');

// Show overlay on first visit
if (!localStorage.getItem('messageDismissed')) {
    flashOverlay.style.display = 'flex';
}

// Hide overlay on click
flashOverlay.addEventListener('click', (e) => {
    // Check if click is outside the play button area
    const playRect = playPauseBtn.getBoundingClientRect();
    const radius = Math.max(playRect.width, playRect.height) / 2;
    const centerX = playRect.left + playRect.width/2;
    const centerY = playRect.top + playRect.height/2;
    const distance = Math.sqrt((e.clientX - centerX)**2 + (e.clientY - centerY)**2);
    
    if (distance > radius) {
        flashOverlay.style.display = 'none';
        localStorage.setItem('messageDismissed', 'true');
    }
});

// Hide overlay when play is clicked
document.getElementById('play-pause').addEventListener('click', () => {
    flashOverlay.style.display = 'none';
    localStorage.setItem('messageDismissed', 'true');
});
    
  let timeoutId = null;

document.getElementById('logoContainer').addEventListener('click', function(e) {
    if (!this.classList.contains('active') && e.target.closest('.logo')) {
        this.classList.add('active');
    }
});

document.getElementById('deleteIcon').addEventListener('click', function(e) {
    clearTimeout(timeoutId);
    timeoutId = setTimeout(() => {
        document.getElementById('logoContainer').classList.remove('active');
    }, 2000); // 2-second delay
});

document.addEventListener('click', function(e) {
    if (!e.target.closest('.logo-container')) {
        clearTimeout(timeoutId);
        document.getElementById('logoContainer').classList.remove('active');
    }
});

// Add this isolated script at the very end of your existing script
(() => {
    const textElements = document.querySelectorAll('.safe-text');
    let textIndex = 0;
    
    setInterval(() => {
        textElements[textIndex].classList.remove('safe-visible');
        textElements[textIndex].classList.add('safe-hidden');
        
        textIndex = (textIndex + 1) % textElements.length;
        
        textElements[textIndex].classList.remove('safe-hidden');
        textElements[textIndex].classList.add('safe-visible');
    }, 10000);
})();
    
    </script>
</body>
</html>  
